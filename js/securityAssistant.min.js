var serverURL="./";const securityAssistantParameters=document.querySelector("#securityAssistant");function append(elString,parent){var div=document.createElement("div");div.innerHTML=elString,document.querySelector(parent||"body").appendChild(div.firstChild)}function getRandomInt(max){return Math.floor(Math.random()*Math.floor(max))}function initDependencies(){var htmlInjection;append('<link id="secAssistantStyleSheet" rel="stylesheet" type="text/css" href="'+serverURL+'css/securityAssistant.css">',"body"),append('<script type="text/x-template" id="modal-template"> <transition name="secAssistant-modal"> <div class="secAssistant-modal-mask"><div class="secAssistant-modal-wrapper"> <div class="secAssistant-modal-container">  <div class="secAssistant-modal-header">  <div style="float: right"><a class="btn-secAssistant btn-danger-secAssistant" @click="$emit(\'close\')"> X </a></div><slot name="header">  </slot></div> <div class="secAssistant-modal-body" id="modalContent"> <slot name="summary"> default body </slot> <slot name="generator"> </slot> <slot name="quiz"> </slot> <slot name="buttons"> </slot> <p></p> <slot name="body"> default body </slot> </div> <div class="secAssistant-modal-footer"> <slot name="footer">  <p>&nbsp;</p></slot> </div> </div> </div> </div> </transition><\/script>',"body"),org_html=document.body.innerHTML,new_html="<div id='app'>"+org_html+"</div>",document.body.innerHTML=new_html,append('<modal v-if="showModal" @close="showModal = false"><div slot="header"> <h2 class="secAssistant-modal-h2">{{ this.modalHeader }}</h2> </div><div slot="summary" v-html="this.modalSummary"></div><div slot="generator" v-if="showGenerator"> <div class="form-group"><label for="exampleInputPassword1">Choose your password, use at least four (4) words</label><input type="password" class="form-control" :value="passwordUser" @input="passwordUser = $event.target.value" id="exampleInputPassword1" placeholder="Password"><br /><vue-simple-progress size="huge" :val="pwStrengthValue" :bar-color="pwStrengthColor" :text="pwStrengthText"></vue-simple-progress><label v-if="false" for="exampleInputPassword1">Detta ord lÃ¤ggs automatiskt pÃ¥</label><input v-if="false" type="text" class="form-control" v-model="passwordAutoWord" id="exampleInputPassword1" disabled></div><p v-if="false">Antal ord {{ this.calculateWords }} </p><p v-if="false">Ditt lÃ¶senord blir: {{ this.generatedPassword }}</p><br /></div><div slot="quiz" v-if="activeQuiz"> <div><p></p><h4 class="secAssistant-header-h4">{{ questions[this.activeQuestion].text }}</h4></div> <div class="list-group"><a style="cursor: pointer;" class="list-group-item list-group-item-action" v-for="(answer, index) in questions[this.activeQuestion].answers" @click="checkAnswer(index)"> {{ answer }} </a></div> <p>&nbsp;</p> <div v-if="showFeedback"> {{ feedback}} </div> <p>&nbsp;</p> </div><div slot="buttons"><div style="float: left;"><a class="btn-secAssistant btn-primary-secAssistant" @click="guideStepNext" v-if="this.guideNavButton !== \'\'"> {{ guideNavButton }} </a> &nbsp; &nbsp; <a class="btn-secAssistant btn-warning-secAssistant" @click="goToGenerator()" v-if="this.skipGuideNavButton !== \'\'"> {{ skipGuideNavButton }} </a></div> <div style="clear:both;"></div> </div> <div slot="body" v-html="this.modalBody"></div> </modal>',"#app"),initVue()}function initVue(){Vue.component("modal",{template:"#modal-template"});var vm=new Vue({el:"#app",components:{},data:{activeQuestion:0,activeQuiz:!1,passwordInputFields:[],submitForm:[],passwordAutoWord:"",passwordUser:"",showModal:!1,showFeedback:!1,showGenerator:!1,feedback:"",generatedPassword:"",modalHeader:"Password tutorial",modalSummary:"",modalBody:"",guideCompleted:!1,guideStep:0,guideNavButton:"Start guide",pwStrengthValueDropbox:0,pwStrengthColor:"#2196f3",pwStrengthText:"",skipGuideNavButton:"Create password now",sawModal:!1,questions:[{text:"Which one of the following is the best password?",type:"mc",answers:["1. Your name or social security number","2. OneprettybluechairFacebook","3. ASFD#%T#GT%#YÂ¤GW#G%Â¤#"],answer:1,feedback:["Wrong, never use information about yourself in your password. It's the first thing a hacker will test!","Correct! ðŸŽ‰","Even if it's long, it's hard to remember without writing it down. Only use this type of password if you can memorize it."]},{text:"What's the most important when choosing a password?",type:"mc",answers:["1. That the password is long and easy to remember","2. That the password is completely randomized","3. That the password contains information about yourself"],answer:0,feedback:["Correct! ðŸŽ‰","Completely randomized passwords may sound good, but are hard to remember. Only use this type of password if you can memorize it.","Wrong, never use information about yourself in your password. It's the first thing a hacker will test!"]},{text:"How should you handle your passwords?",type:"mc",answers:["1. Write them down on paper to remember them","2. Use the same password for all accounts but change it often","3. Use unique passwords for your accounts, but make them easy to remember"],answer:2,feedback:["Never write down your passwords, an attacker could find the paper or the file! Instead create passwords that are easy to remember by using a sentence with at least four words.","Using the same password on various sites is dangerous. If a hacker attacks a site and gets your password he will be able to log in to all of your accounts. Changing passwords often makes them hard to remember and is not recommended anymore by leading organizations.","Correct! ðŸŽ‰ Instead use a phrase with at least four words, followed by the site it's being used. For examle OneTinyLittleTreeFacebook."]}]},methods:{addListenersToPasswordInputFields:function(){var that=this,cat=getRandomInt(100)>=parseInt(securityAssistantParameters.dataset.frequency);if(console.log(cat),cat)this.submitForm[0][0].addEventListener("submit",(function(e){var form=this,submittedPassword="";e.preventDefault();for(var i=0;i<form.length;i++)if("password"===form[i].type){submittedPassword=form[i].value;break}""!==submittedPassword&&(""!==window.location.hostname?that.passwordAutoWord=that.parseDomain(window.location.hostname):that.passwordAutoWord="Unknown",that.sendTelemetrics(submittedPassword,that.sawModal,that.guideCompleted,that.passwordAutoWord)),setTimeout((function(){form.submit()}),2500)}));else if(!0!==this.sessionStorageCheck()){for(var i=0;i<this.passwordInputFields.length;i++){this.passwordInputFields[i].addEventListener("focus",(function(){that.showModal=!0,that.activeQuiz||that.showGenerator||(that.guideCompleted?that.goToGenerator():(that.modalHeader="Password tutorial",that.guideNavButton="Learn more",that.modalSummary='<img class="modalImage" src="'+serverURL+'img/authentication.svg" /><h4 class="secAssistant-header-h4">A good password is easy to remember and hard to crack!</h4><p>You can achieve this by using a phrase <strong>at least four words</strong> long. Remember to never <strong>use any personal information such as social security numbers or names</strong> in your passwords.</p><p>Do you want to learn more about creating a good password, or jump straight to creating it?</p><p>&nbsp;</p>',that.modalBody="",that.guideStep=1,that.sawModal=!0))}));break}this.submitForm[0][0].addEventListener("submit",(function(e){var form=this,submittedPassword="";e.preventDefault();for(var i=0;i<form.length;i++)if("password"===form[i].type){submittedPassword=form[i].value;break}""!==submittedPassword&&(""!==window.location.hostname?that.passwordAutoWord=that.parseDomain(window.location.hostname):that.passwordAutoWord="Unknown",that.sendTelemetrics(submittedPassword,that.sawModal,that.guideCompleted,that.passwordAutoWord)),setTimeout((function(){form.submit()}),2500)}))}},checkAnswer:function(answer){var match=this.questions[this.activeQuestion].answer===answer;this.showFeedback=!0,this.feedback=this.questions[this.activeQuestion].feedback[answer],this.guideNavButton=match?"Next question":""},checkPass:function(passwordCheck,sawPrompt,finishedTutorial,domain){var estimator=zxcvbn(passwordCheck,user_inputs=[]);axios({method:"post",url:"https://sa.xenolith.se/api/NewStatistics/",data:{passwordLength:passwordCheck.length,numbers:passwordCheck.replace(/[^0-9]/g,"").length,upperCases:passwordCheck.replace(/[^A-Z]/g,"").length,lowerCases:lowerCases=passwordCheck.replace(/[^a-z]/g,"").length,specialCharacters:passwordCheck.replace(/[^@#$%^&!*()_+\-=\[\]{};':"\\|,.<>\/?]/g,"").length,domain:domain,fullDomain:document.location.href,sawPrompt:sawPrompt,finishedTutorial:finishedTutorial,offlineFastHashing1e10PerSecond:estimator.crack_times_seconds.offline_fast_hashing_1e10_per_second,offlineSlowHashing1e4PerSecond:estimator.crack_times_seconds.offline_slow_hashing_1e4_per_second,onlineNoThrottling10PerSecond:estimator.crack_times_seconds.online_no_throttling_10_per_second,onlineThrottling100PerSecond:estimator.crack_times_seconds.online_throttling_100_per_hour,offlineFastHashingDisplay:estimator.crack_times_display.offline_fast_hashing_1e10_per_second,offlineSlowHashingDisplay:estimator.crack_times_display.offline_slow_hashing_1e4_per_second,onlineNoThrottlingDisplay:estimator.crack_times_display.online_no_throttling_10_per_second,onlineThrottlingDisplay:estimator.crack_times_display.online_throttling_100_per_hour,calcTime:estimator.calc_time,guesses:estimator.guesses,score:estimator.score,suggestions:estimator.feedback.suggestions.join(),warnings:estimator.feedback.warning}}).then(response=>{}).catch((function(error){console.log(error)}))},findAllPasswordInputFields:function(callback){const forms=document.querySelectorAll("form");if(0!==forms.length)for(var i=0;i<forms.length;i++){const form=forms[0];var formHasPw=!1,formHasUser=!1;form.length<=3?([...form.elements].forEach(input=>{"text"===input.type||"email"===input.type?formHasUser=!0:"password"===input.type&&(formHasPw=!0,this.passwordInputFields.push(input))}),formHasUser&&formHasPw&&(this.passwordInputFields=[])):([...form.elements].forEach(input=>{"text"===input.type||"email"===input.type?formHasUser=!0:"password"===input.type?(formHasPw=!0,this.passwordInputFields.push(input)):"submit"===input.type&&this.submitForm.push(forms)}),formHasUser&&formHasPw||(this.passwordInputFields=[],this.submitForm=[]))}callback()},goToGenerator:function(){this.guideStep=7,this.skipGuideNavButton="",this.guideLoadNextStep()},guideStepNext:function(){this.guideStep+=1,this.guideLoadNextStep()},guideLoadNextStep:function(){if(2===this.guideStep)this.activeQuiz||this.showGenerator||(document.getElementById("modalContent").scrollTop=0,this.modalSummary='<img class="modalImage" src="'+serverURL+'img/password-strength.gif" /><p></p><h4 class="secAssistant-header-h4">Create better passwords by making them longer!</h4><p>The more words the better. Remember to <strong>never write down your password</strong> on a piece of paper or on some file on your computer or phone.</p><p>You can make the password unique by adding a word for where it\'s to be used, for example if the password is to be used on Facebook, adding the word "Facebook" to the password phrase.</p><p>In the next step you will get to <strong>test your knowledge</strong>, before creating a new password for this site!</p><p>&nbsp;</p><p>&nbsp;</p>',this.guideNavButton="Take a quick quiz");else if(3===this.guideStep)this.modalSummary="",this.guideNavButton="",this.activeQuiz=!0,this.skipGuideNavButton="";else if(4===this.guideStep)this.showFeedback=!1,this.modalSummary="",this.guideNavButton="",this.activeQuestion+=1,this.activeQuiz=!0;else if(5===this.guideStep)this.showFeedback=!1,this.modalSummary="",this.guideNavButton="",this.activeQuestion+=1,this.activeQuiz=!0;else if(6===this.guideStep)this.activeQuestion=0,this.activeQuiz=!1,this.showFeedback=!1,this.modalSummary='<img class="modalImage" src="'+serverURL+'img/celebration.svg" /><h3 class="secAssistant-header-h3">Well done!</h3><p>In the next step you get to create your new password.</p><p><strong>Take a look around and make sure no one is looking at your screen before starting!</strong></p><p>&nbsp;</p>',this.guideNavButton="Create your password",this.skipGuideNavButton="";else if(7===this.guideStep)this.modalSummary="",this.showGenerator=!0,this.guideNavButton="Use this password",""!==window.location.hostname?this.passwordAutoWord=this.parseDomain(window.location.hostname):this.passwordAutoWord="Unknown";else if(8===this.guideStep){var that=this;this.pwStrengthValue<40?this.modalSummary='<svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52"><circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/><path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/></svg><div style="text-align: center;"><h3 class="secAssistant-header-h3">All done! ðŸŽ‰</h3><p>Your password could however be better, try adding another word.</p><p style="font-size: 12px;">This window will close in five seconds</p></div>':this.pwStrengthValue>40&&this.pwStrengthValue<66?this.modalSummary='<svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52"><circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/><path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/></svg><div style="text-align: center;"><h3 class="secAssistant-header-h3">Well done! ðŸŽ‰</h3><p>You now have a good password, it can however be even better, try adding another word.</p><p style="font-size: 12px;">This window will close in five seconds</p></div>':this.pwStrengthValue>66?this.modalSummary='<svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52"><circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/><path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/></svg><div style="text-align: center;"><h3 class="secAssistant-header-h3">Well done! ðŸŽ‰</h3><p>You now have a secure password!</p><p style="font-size: 12px;">This window will close in five seconds</p></div>':this.modalSummary='<svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52"><circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/><path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/></svg><div style="text-align: center;"><h3 class="secAssistant-header-h3">All done! ðŸŽ‰</h3><p>Your chosen password is very weak and easy to crack, try adding a few more words.</p><p style="font-size: 12px;">This window will close in five seconds</p></div>',this.showFeedback=!1,this.showGenerator=!1,this.guideNavButton="",this.activeQuiz=!1,this.generatedPassword=this.passwordUser,this.passwordInputFields[0].value=this.generatedPassword,this.guideCompleted=!0,setTimeout((function(){that.showModal=!1}),4e3)}},sessionStorageAdd:function(){sessionStorage.setItem("securityAssistantShown",window.location.href)},sessionStorageCheck:function(){return sessionStorage.getItem("securityAssistantShown")===window.location.href},parseDomain:function(url){var TLDs=["ac","ad","ae","aero","af","ag","ai","al","am","an","ao","aq","ar","arpa","as","asia","at","au","aw","ax","az","ba","bb","bd","be","bf","bg","bh","bi","biz","bj","bm","bn","bo","br","bs","bt","bv","bw","by","bz","ca","cat","cc","cd","cf","cg","ch","ci","ck","cl","cm","cn","co","com","coop","cr","cu","cv","cx","cy","cz","de","dj","dk","dm","do","dz","ec","edu","ee","eg","er","es","et","eu","fi","fj","fk","fm","fo","fr","ga","gb","gd","ge","gf","gg","gh","gi","gl","gm","gn","gov","gp","gq","gr","gs","gt","gu","gw","gy","hk","hm","hn","hr","ht","hu","id","ie","il","im","in","info","int","io","iq","ir","is","it","je","jm","jo","jobs","jp","ke","kg","kh","ki","km","kn","kp","kr","kw","ky","kz","la","lb","lc","li","lk","lr","ls","lt","lu","lv","ly","ma","mc","md","me","mg","mh","mil","mk","ml","mm","mn","mo","mobi","mp","mq","mr","ms","mt","mu","museum","mv","mw","mx","my","mz","na","name","nc","ne","net","nf","ng","ni","nl","no","np","nr","nu","nz","om","org","pa","pe","pf","pg","ph","pk","pl","pm","pn","pr","pro","ps","pt","pw","py","qa","re","ro","rs","ru","rw","sa","sb","sc","sd","se","sg","sh","si","sj","sk","sl","sm","sn","so","sr","st","su","sv","sy","sz","tc","td","tel","tf","tg","th","tj","tk","tl","tm","tn","to","tp","tr","travel","tt","tv","tw","tz","ua","ug","uk","us","uy","uz","va","vc","ve","vg","vi","vn","vu","wf","ws","xn--0zwm56d","xn--11b5bs3a9aj6g","xn--3e0b707e","xn--45brj9c","xn--80akhbyknj4f","xn--90a3ac","xn--9t4b11yi5a","xn--clchc0ea0b2g2a9gcd","xn--deba0ad","xn--fiqs8s","xn--fiqz9s","xn--fpcrj9c3d","xn--fzc2c9e2c","xn--g6w251d","xn--gecrj9c","xn--h2brj9c","xn--hgbk6aj7f53bba","xn--hlcj6aya9esc7a","xn--j6w193g","xn--jxalpdlp","xn--kgbechtv","xn--kprw13d","xn--kpry57d","xn--lgbbat1ad8j","xn--mgbaam7a8h","xn--mgbayh7gpa","xn--mgbbh1a71e","xn--mgbc0a9azcg","xn--mgberp4a5d4ar","xn--o3cw4h","xn--ogbpf8fl","xn--p1ai","xn--pgbs0dh","xn--s9brj9c","xn--wgbh1c","xn--wgbl6a","xn--xkc2al3hye2a","xn--xkc2dl3a5ee0h","xn--yfro4i67o","xn--ygbi2ammx","xn--zckzah","xxx","ye","yt","za","zm","zw"].join(),parts=url.split(".");"www"===parts[0]&&"com"!==parts[1]&&parts.shift();for(var ln=parts.length,i=ln,minLength=parts[parts.length-1].length,part;part=parts[--i];)if(0===i||i<ln-2||part.length<minLength||TLDs.indexOf(part)<0)return part},sendTelemetrics:function(password,sawModal,didGuide,passwordAutoWord){this.checkPass(password,sawModal,didGuide,passwordAutoWord)},strengthCalculator:function(){}},computed:{calculateWords:function(){},pwStrengthValue:function(){return this.pwStrengthValueDropbox=zxcvbn(this.passwordUser,user_inputs=[]),0===this.pwStrengthValueDropbox.score?(this.pwStrengthText="Very weak password",this.pwStrengthColor="#f96868",5):1===this.pwStrengthValueDropbox.score?(this.pwStrengthText="Weak password",this.pwStrengthColor="#f96868",15):2===this.pwStrengthValueDropbox.score?(this.pwStrengthText="Average password",this.pwStrengthColor="#178de5",35):3===this.pwStrengthValueDropbox.score?(this.pwStrengthText="Stronger password",this.pwStrengthColor="#178de5",65):4===this.pwStrengthValueDropbox.score?(this.pwStrengthText="Very strong password",this.pwStrengthColor="#1abc9c",100):void 0}},mounted:function(){var that=this;this.findAllPasswordInputFields((function(){that.addListenersToPasswordInputFields()}))}})}initDependencies();